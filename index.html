<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portafolio Profesional - Genaro S√°nchez</title>
    
    <!-- 1. Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. React y ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- 3. Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 4. Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { font-family: sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #0f172a; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, onSnapshot, collection, addDoc, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const { useState, useEffect, useRef, useCallback } = React;
        
        // --- CONFIGURACI√ìN REAL (curriculum-cb122) ---
        const firebaseConfig = {
            apiKey: "AIzaSyAgsBSRUq8_06oieVSHFUiofB7YA7ezwOM",
            authDomain: "curriculum-cb122.firebaseapp.com",
            projectId: "curriculum-cb122",
            storageBucket: "curriculum-cb122.firebasestorage.app",
            messagingSenderId: "372424010484",
            appId: "1:372424010484:web:c580abd52c6dac4784cca1",
            measurementId: "G-WP8Y7EKMVP"
        };

        // Inicializaci√≥n
        let app, analytics, auth, db;
        try {
            app = initializeApp(firebaseConfig);
            analytics = getAnalytics(app); 
            auth = getAuth(app);
            db = getFirestore(app);
        } catch (err) {
            console.error("Error inicializando Firebase:", err);
        }
        
        const appId = 'portfolio-genaro-main'; 
        const apiKey = ""; 

        // --- ICONOS ---
        const createLucideIcon = (iconName, iconNode) => {
            if (!iconNode) return () => null;
            return ({ size = 24, className, ...props }) => {
                return React.createElement('svg', {
                    xmlns: "http://www.w3.org/2000/svg",
                    width: size,
                    height: size,
                    viewBox: "0 0 24 24",
                    fill: "none",
                    stroke: "currentColor",
                    strokeWidth: 2,
                    strokeLinecap: "round",
                    strokeLinejoin: "round",
                    className: className,
                    ...props
                }, iconNode.map(([tag, attrs], index) => 
                    React.createElement(tag, { ...attrs, key: index })
                ));
            };
        };

        const requiredIcons = [
            "Save", "Edit2", "Check", "Upload", "Award", "Server", "Shield", "Monitor", "Mail", "Phone", "MapPin", 
            "ExternalLink", "Menu", "X", "Download", "FileText", "Smartphone", "ShoppingBag", "Coffee", "Plane", 
            "Scissors", "Stethoscope", "Briefcase", "MessageCircle", "Facebook", "GraduationCap", "Lock", 
            "LogOut", "Layout", "Loader", "Sparkles", "Bot", "Send", "User", "Calendar", "FileCheck", "Clock", 
            "ArrowLeft", "ChevronRight", "AlertCircle", "File", "Eye"
        ];

        const Icons = requiredIcons.reduce((acc, name) => {
            acc[name] = createLucideIcon(name, lucide.icons[name]);
            return acc;
        }, {});

        const { 
            Save, Edit2, Check, Upload, Award, Server, Shield, Monitor, Mail, Phone, MapPin, 
            ExternalLink, Menu, X, Download, FileText, Smartphone, ShoppingBag, Coffee, Plane, 
            Scissors, Stethoscope, Briefcase, MessageCircle, Facebook, GraduationCap, Lock, 
            LogOut, Layout, Loader, Sparkles, Bot, Send, User, Calendar, FileCheck, Clock, 
            ArrowLeft, ChevronRight, AlertCircle, File, Eye 
        } = Icons;

        const IconMap = { 
          Shield, Server, Monitor, Award, 
          Smartphone, ShoppingBag, Coffee, 
          Plane, Scissors, Stethoscope, Briefcase 
        };

        // --- PDF LOGIC ---
        const usePdfThumbnail = () => {
          const [isReady, setIsReady] = useState(false);
          useEffect(() => {
            if (window.pdfjsLib) { setIsReady(true); return; }
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js';
            script.async = true;
            script.onload = () => {
              window.pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
              setIsReady(true);
            };
            document.body.appendChild(script);
          }, []);

          const generateThumbnail = useCallback(async (input) => {
            if (!window.pdfjsLib || !input) return null;
            try {
              let arrayBuffer;
              // CAMBIO: Verificaci√≥n m√°s robusta que no depende de instanceof File
              if (typeof input === 'string') {
                 // Es una cadena (URL o Base64)
                 if (input.includes('application/pdf')) {
                    const res = await fetch(input);
                    arrayBuffer = await res.arrayBuffer();
                 } else {
                    return null;
                 }
              } else if (input && typeof input.arrayBuffer === 'function') {
                 // Es un objeto File o Blob (tiene m√©todo arrayBuffer)
                 arrayBuffer = await input.arrayBuffer();
              } else {
                 return null;
              }

              const pdf = await window.pdfjsLib.getDocument(arrayBuffer).promise;
              const page = await pdf.getPage(1);
              const viewport = page.getViewport({ scale: 1.0 });
              const canvas = document.createElement('canvas');
              const context = canvas.getContext('2d');
              canvas.height = viewport.height;
              canvas.width = viewport.width;
              await page.render({ canvasContext: context, viewport }).promise;
              return canvas.toDataURL();
            } catch (err) { console.error(err); return null; }
          }, [isReady]);
          return { generateThumbnail, isReady };
        };

        const FileUploader = ({ currentFile, onFileUpdate, label, circular = false, aspectClass = "aspect-video", allowPdf = false }) => {
          const fileInputRef = useRef(null);
          const [loading, setLoading] = useState(false);
          const { generateThumbnail, isReady } = usePdfThumbnail();
          const [thumbnail, setThumbnail] = useState(null);
          const isPdf = currentFile?.includes('application/pdf');

          useEffect(() => {
            let mounted = true;
            if (isPdf && isReady && currentFile) {
                generateThumbnail(currentFile).then(url => { if (mounted && url) setThumbnail(url); });
            } else if (!isPdf) setThumbnail(null);
            return () => { mounted = false; };
          }, [currentFile, isReady, isPdf, generateThumbnail]);

          const handleFileChange = async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            setLoading(true);
            
            if (file.type === 'application/pdf') {
                if (!allowPdf) { alert("Solo im√°genes permitidas aqu√≠."); setLoading(false); return; }
                if (file.size > 1024 * 1024) { alert("PDF muy pesado (+1MB)."); setLoading(false); return; }
                const reader = new FileReader();
                reader.onload = async (ev) => {
                    const base64File = ev.target.result;
                    if (isReady) { const thumb = await generateThumbnail(file); setThumbnail(thumb); }
                    onFileUpdate(base64File);
                    setLoading(false);
                };
                reader.readAsDataURL(file);
            } else if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = (event) => {
                  const img = new Image();
                  img.src = event.target.result;
                  img.onload = () => {
                    const canvas = document.createElement('canvas');
                    let width = img.width; let height = img.height;
                    const MAX_WIDTH = 1200; const MAX_HEIGHT = 1200;
                    if (width > height) { if (width > MAX_WIDTH) { height *= MAX_WIDTH / width; width = MAX_WIDTH; } } 
                    else { if (height > MAX_HEIGHT) { width *= MAX_HEIGHT / height; height = MAX_HEIGHT; } }
                    canvas.width = width; canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    onFileUpdate(canvas.toDataURL('image/jpeg', 0.7));
                    setLoading(false);
                  };
                };
            } else { alert("Formato no soportado."); setLoading(false); }
          };

          const displayImage = isPdf ? thumbnail : currentFile;

          return (
            <div className={`relative group cursor-pointer overflow-hidden ${circular ? 'rounded-full' : 'rounded-lg bg-slate-100'} ${aspectClass} flex items-center justify-center border-2 border-dashed border-slate-300 hover:border-blue-400 transition-colors shadow-inner`} onClick={() => fileInputRef.current.click()} title={allowPdf ? "Clic para subir" : "Clic para subir Imagen"}>
              {currentFile ? (
                <>{displayImage ? (<>{!circular && (<div className="absolute inset-0 bg-cover bg-center blur-md opacity-60 scale-125" style={{ backgroundImage: `url(${displayImage})` }}></div>)}<img src={displayImage} alt={label} className={`relative z-10 w-full h-full ${circular ? 'object-cover' : 'object-contain p-1'} ${circular ? 'rounded-full' : 'rounded-lg shadow-sm'}`} />{isPdf && (<div className="absolute top-2 left-2 z-20 bg-red-500 text-white text-[9px] font-bold px-2 py-0.5 rounded shadow">PDF</div>)}</>) : (<div className="flex flex-col items-center text-slate-400 animate-pulse"><FileText size={24} /><span className="text-[10px] mt-1">Procesando...</span></div>)}<div className="absolute inset-0 z-20 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center backdrop-blur-sm rounded-lg"><Upload className="text-white" size={24} /><span className="text-white text-xs font-medium ml-2">Cambiar</span></div></>
              ) : (<div className="flex flex-col items-center text-slate-400 p-2 text-center"><Upload size={20} className="mb-1" /><span className="text-[10px] font-medium leading-tight">{label}</span>{allowPdf && <span className="text-[8px] text-blue-400 mt-1 font-bold">IMG / PDF</span>}</div>)}
              <input type="file" ref={fileInputRef} onChange={handleFileChange} accept={allowPdf ? "image/*,application/pdf" : "image/*"} className="hidden" />
              {loading && (<div className="absolute inset-0 bg-white/90 z-30 flex items-center justify-center"><div className="w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"></div></div>)}
            </div>
          );
        };

        const DEFAULT_DATA = {
          profile: {
            name: "Genaro S√°nchez Bravo",
            title: "T√©cnico Especializado en Inform√°tica & Consultor",
            bio: "Profesional multidisciplinario enfocado en brindar soluciones tecnol√≥gicas integrales...",
            image: null,
            location: "Prof. Dolores Gonz√°lez 2, Col la Cuchilla, 75520 Cdad. Serd√°n, Pue.",
            mapUrl: "https://maps.app.goo.gl/SuQPvrECnD8SsL8w7",
            email: "oraneg_sb@hotmail.com",
            phone: "245 207 0033",
            facebookUrl: "https://www.facebook.com/genaro.sanchez.5243817",
            education: [{ id: 1, title: "Licenciatura en Contabilidad y Finanzas", school: "UTEL", status: "En Curso" }, { id: 2, title: "Licenciatura en Psicolog√≠a", school: "UGM", status: "En Curso" }],
            skills: ["Desarrollo Web", "Consultor√≠a TI", "Gesti√≥n Administrativa", "Soporte T√©cnico"]
          },
          serviceShowcase: [ { id: 's1', label: "Micrositios de Citas", image: null }, { id: 's2', label: "Men√∫s Digitales QR", image: null }, { id: 's3', label: "Cat√°logo de Productos", image: null }, { id: 's4', label: "Tarjeta Digital (vCard)", image: null }, { id: 's5', label: "Agencias de Viajes", image: null }, { id: 's6', label: "Salones y Spas", image: null } ],
          services: [ { id: 1, category: "Salud y Servicios", title: "Micrositios de Citas", desc: "Landing Pages de alta conversi√≥n.", price: "$2,500 - $3,500 MXN", features: ["Info negocio", "Bot√≥n WhatsApp", "Ubicaci√≥n Google Maps", "Formulario Contacto"], icon: "Stethoscope" }, { id: 2, category: "Restaurantes", title: "Men√∫s Digitales QR", desc: "Digitalizaci√≥n total del men√∫.", price: "$1,800 - $2,500 MXN", features: ["Responsivo", "Fotos HD", "Redes Sociales", "Precios din√°micos"], icon: "Coffee" }, { id: 3, category: "Comercio", title: "Cat√°logo Digital", desc: "Tu inventario en l√≠nea 24/7.", price: "$3,500 - $5,000 MXN", features: ["Categor√≠as", "Buscador", "Fotos detalle", "Cotizar WhatsApp"], icon: "ShoppingBag" }, { id: 4, category: "Profesional", title: "Tarjeta Digital (vCard)", desc: "Enlace √∫nico profesional.", price: "$800 - $1,200 MXN", features: ["Foto/Portada", "Botones llamada", "Redes Sociales", "Guardar Contacto"], icon: "Smartphone" }, { id: 5, category: "Turismo", title: "Agencias de Viajes", desc: "Folleto digital interactivo.", price: "$3,000 - $4,500 MXN", features: ["Galer√≠a destinos", "Itinerarios", "Paquetes", "Cotizar Viaje"], icon: "Plane" }, { id: 6, category: "Belleza", title: "Salones y Spas", desc: "Sitio de reservas.", price: "$2,500 - $3,500 MXN", features: ["Men√∫ servicios", "Galer√≠a Antes/Despu√©s", "Agenda WhatsApp", "Mapa"], icon: "Scissors" } ],
          certificates: [ { id: 'c1', title: "T√©cnico en Inform√°tica", issuer: "Centro Escolar Fco. I. Madero", date: "2024", image: null }, { id: 'c2', title: "Auditor√≠a y Gesti√≥n", issuer: "Auditor√≠a Superior Puebla", date: "2019", image: null }, { id: 'c3', title: "Insignia Executive", issuer: "Universidad UTEL", date: "2024", image: null }, { id: 'c4', title: "Autoobservaci√≥n", issuer: "UTEL", date: "Sept 2025", image: null }, { id: 'c5', title: "Delitos Patrimonio", issuer: "UTEL", date: "Sept 2025", image: null }, { id: 'c6', title: "Propiedad Intelectual", issuer: "UTEL", date: "Sept 2025", image: null }, { id: 'c7', title: "Manejo del Enojo", issuer: "UTEL", date: "Sept 2025", image: null }, { id: 'c8', title: "Obst√°culos al √âxito", issuer: "UTEL", date: "Ago 2025", image: null }, { id: 'c9', title: "Transparencia Coaching", issuer: "UTEL", date: "Ago 2025", image: null }, { id: 'c10', title: "Familia y Salud Mental", issuer: "UTEL", date: "Jul 2025", image: null }, { id: 'c11', title: "Emprendimiento", issuer: "UTEL", date: "Jun 2025", image: null }, { id: 'c12', title: "Econom√≠a Sana", issuer: "UTEL", date: "Jun 2025", image: null }, { id: 'c13', title: "Estrategias Negocios", issuer: "UTEL", date: "Jun 2025", image: null }, { id: 'c14', title: "Desarrollo Personal", issuer: "UTEL", date: "Jun 2025", image: null }, { id: 'c15', title: "H√°bitos Saludables", issuer: "UTEL", date: "May 2025", image: null }, { id: 'c16', title: "Habilidades Directivas", issuer: "UTEL", date: "Abr 2025", image: null }, { id: 'c17', title: "Mindset Responsable", issuer: "UTEL", date: "Abr 2025", image: null }, { id: 'c18', title: "Finanzas Personales", issuer: "UTEL", date: "Abr 2025", image: null } ]
        };

        function Portfolio() {
          const [data, setData] = useState(null);
          const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
          const [user, setUser] = useState(null);
          const [permissionError, setPermissionError] = useState(false);
          
          const [isAuthenticated, setIsAuthenticated] = useState(false);
          const [isEditing, setIsEditing] = useState(false);
          const [showLoginModal, setShowLoginModal] = useState(false);
          const [loginUser, setLoginUser] = useState("");
          const [loginPass, setLoginPass] = useState("");
          const [loginError, setLoginError] = useState("");
          const [isSaving, setIsSaving] = useState(false);

          const [showAIModal, setShowAIModal] = useState(false);
          const [aiInput, setAiInput] = useState("");
          const [aiResponse, setAiResponse] = useState(null);
          const [aiLoading, setAiLoading] = useState(false);
          const [showScheduler, setShowScheduler] = useState(false);
          const [selectedDate, setSelectedDate] = useState("");
          const [selectedTime, setSelectedTime] = useState("");
          const [bookedSlots, setBookedSlots] = useState([]);
          const [isBooking, setIsBooking] = useState(false);

          // 1. AUTENTICACI√ìN
          useEffect(() => {
            const initAuth = async () => {
              try {
                  await signInAnonymously(auth);
              } catch (e) { 
                  console.error("Error de Autenticaci√≥n:", e);
                  if (e.code === 'auth/configuration-not-found' || e.code === 'auth/operation-not-allowed') {
                      alert("‚ö†Ô∏è ERROR DE CONFIGURACI√ìN FIREBASE:\n\nDebes habilitar 'Anonymous' en: Authentication > Sign-in method");
                  }
              }
            };
            initAuth();
            if (auth) {
                const unsubscribe = onAuthStateChanged(auth, setUser);
                return () => unsubscribe();
            }
          }, []);

          // 2. SINCRONIZACI√ìN DE DATOS
          useEffect(() => {
            if (!user || !db) return;
            const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'portfolio_content', 'main');
            const unsubscribe = onSnapshot(docRef, (docSnap) => {
              if (docSnap.exists()) { setData(prev => ({ ...DEFAULT_DATA, ...docSnap.data() })); } 
              else { setData(DEFAULT_DATA); }
            }, (error) => {
                console.error("Error fetching data:", error);
                
                // DETECCI√ìN DE ERROR DE PERMISOS
                if (error.code === 'permission-denied' || error.message.includes("Missing or insufficient permissions")) {
                    setPermissionError(true);
                }
                
                setData(DEFAULT_DATA); // Fallback a datos locales
            });
            return () => unsubscribe();
          }, [user]);

          // 3. RECUPERAR CITAS OCUPADAS
          useEffect(() => {
            if (!user || !selectedDate || !db) return;
            const fetchBookedSlots = async () => {
              const q = query(collection(db, 'artifacts', appId, 'public', 'data', 'appointments'), where("date", "==", selectedDate));
              try {
                  const querySnapshot = await getDocs(q);
                  const slots = [];
                  querySnapshot.forEach((doc) => slots.push(doc.data().time));
                  setBookedSlots(slots);
              } catch (e) { console.error(e); }
            };
            fetchBookedSlots();
          }, [selectedDate, user]);

          // --- PANTALLA DE AYUDA DE REGLAS DE SEGURIDAD ---
          if (permissionError) {
              return (
                  <div className="min-h-screen bg-slate-900 flex items-center justify-center p-6 text-white font-sans">
                      <div className="max-w-3xl bg-slate-800 p-8 rounded-2xl shadow-2xl border border-red-500/50">
                          <div className="flex items-center gap-4 mb-6">
                              <div className="bg-red-500/20 p-3 rounded-full text-red-400"><AlertCircle size={40} /></div>
                              <h1 className="text-2xl font-bold">Acceso Bloqueado por Reglas de Seguridad</h1>
                          </div>
                          <p className="text-slate-300 mb-4 leading-relaxed">
                              Est√°s en <strong>Modo Producci√≥n</strong>, lo cual es excelente, pero Firebase est√° bloqueando tu app porque no has definido qu√© rutas son seguras.
                          </p>
                          <p className="text-slate-300 mb-6">
                              Para arreglarlo, copia este c√≥digo exacto y p√©galo en <strong>Firebase Console &gt; Firestore Database &gt; Reglas</strong>:
                          </p>
                          
                          <div className="bg-black/50 p-4 rounded-xl font-mono text-xs text-green-400 mb-6 overflow-x-auto border border-slate-700 relative group">
<pre>{`rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // 1. Permitir lectura/escritura en tu Portafolio
    match /artifacts/portfolio-genaro-main/public/data/portfolio_content/{document=**} {
      allow read, write: if true;
    }
    
    // 2. Permitir a clientes crear citas (pero no leer/borrar todo)
    match /artifacts/portfolio-genaro-main/public/data/appointments/{document=**} {
      allow read, create: if true;
    }
  }
}`}</pre>
                              <button onClick={() => {navigator.clipboard.writeText(`rules_version = '2';\nservice cloud.firestore {\n  match /databases/{database}/documents {\n    match /artifacts/portfolio-genaro-main/public/data/portfolio_content/{document=**} {\n      allow read, write: if true;\n    }\n    match /artifacts/portfolio-genaro-main/public/data/appointments/{document=**} {\n      allow read, create: if true;\n    }\n  }\n}`); alert("Reglas copiadas al portapapeles!");}} className="absolute top-4 right-4 bg-slate-700 hover:bg-slate-600 text-white px-3 py-1 rounded text-xs font-bold">Copiar</button>
                          </div>

                          <div className="flex gap-4">
                              <a href="https://console.firebase.google.com/project/curriculum-cb122/firestore/rules" target="_blank" className="bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg transition-colors flex-1 text-center">
                                  Ir a la Consola de Firebase
                              </a>
                              <button onClick={() => window.location.reload()} className="bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                                  Ya lo hice, Recargar
                              </button>
                          </div>
                      </div>
                  </div>
              );
          }

          // GUARDAR CAMBIOS
          const saveDataToCloud = async () => {
            if (!user || !data) return;
            setIsSaving(true);
            try {
              const docRef = doc(db, 'artifacts', appId, 'public', 'data', 'portfolio_content', 'main');
              await setDoc(docRef, data);
              setIsSaving(false);
              setIsEditing(false);
            } catch (error) { console.error("Error guardando:", error); setIsSaving(false); alert("Error al guardar: " + error.code); }
          };

          const confirmBooking = async () => {
            if (!user || !selectedDate || !selectedTime) return;
            setIsBooking(true);
            try {
              await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'appointments'), {
                date: selectedDate, time: selectedTime, bookedAt: new Date().toISOString(), status: 'confirmed_via_whatsapp'
              });
              const message = `Hola Genaro, habl√© con Yenner.\n\n${aiResponse?.technicalSummary || 'Inter√©s General'}\n\nüìÖ CITA CONFIRMADA:\nFecha: ${selectedDate}\nHora: ${selectedTime}`;
              window.open(`https://wa.me/52${data.profile.phone.replace(/\s/g, '')}?text=${encodeURIComponent(message)}`, '_blank');
              setIsBooking(false); setShowAIModal(false); setSelectedDate(""); setSelectedTime("");
              alert("¬°Cita bloqueada! Redirigiendo a WhatsApp...");
            } catch (error) { console.error("Error reservando:", error); setIsBooking(false); alert("Error al reservar."); }
          };

          const handleConsultAI = async (e) => {
            e.preventDefault();
            if (!aiInput.trim()) return;
            setAiLoading(true); setAiResponse(null); setShowScheduler(false);
            if (!apiKey) { alert("Debes configurar la API Key de Gemini en el c√≥digo."); setAiLoading(false); return; }
            const servicesContext = data.services.map(s => `- ${s.title}: ${s.desc} (Precio: ${s.price})`).join("\n");
            const prompt = `Tu Nombre: Yenner. Rol: Asesor. Servicios: ${servicesContext}. Cliente: "${aiInput}". Formato: [Consejo] RESUMEN_TECNICO: [Resumen]`;
            try {
              const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, { method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] }) });
              const result = await response.json();
              const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
              if (text) { const parts = text.split("RESUMEN_TECNICO:"); setAiResponse({ advice: parts[0].trim(), technicalSummary: parts[1] ? parts[1].trim() : `Cliente interesado en: ${aiInput}.` }); } 
              else { setAiResponse({ advice: "Lo siento, intenta ser m√°s espec√≠fico.", technicalSummary: "" }); }
            } catch (error) { setAiResponse({ advice: "Error de conexi√≥n con Yenner.", technicalSummary: "" }); }
            setAiLoading(false);
          };

          const generateTimeSlots = () => {
            const slots = []; for (let i = 9; i <= 18; i++) { slots.push(`${i}:00`); if (i < 18) slots.push(`${i}:30`); }
            return slots;
          };

          const updateField = (s, f, v) => setData(p => ({ ...p, [s]: { ...p[s], [f]: v } }));
          const updateCert = (id, f, v) => setData(p => ({ ...p, certificates: p.certificates.map(c => c.id === id ? { ...c, [f]: v } : c) }));
          const updateShowcase = (id, i) => setData(p => ({ ...p, serviceShowcase: p.serviceShowcase.map(s => s.id === id ? { ...s, image: i } : s) }));
          
          const handleLogin = (e) => {
            e.preventDefault();
            // --- CAMBIA AQU√ç TU USUARIO Y CONTRASE√ëA ---
            const MI_USUARIO = "genaro"; 
            const MI_CONTRASE√ëA = "sanchez2025"; 

            if (loginUser === MI_USUARIO && loginPass === MI_CONTRASE√ëA) { 
                setIsAuthenticated(true); 
                setIsEditing(true); 
                setShowLoginModal(false); 
            } else {
                setLoginError("Credenciales incorrectas");
            }
          };

          const openFileViewer = (fileUrl) => {
              if (!fileUrl) return;
              const win = window.open();
              if (fileUrl.startsWith('data:application/pdf')) { win.document.write(`<iframe src="${fileUrl}" frameborder="0" style="border:0; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%;" allowfullscreen></iframe>`); } 
              else { win.document.write(`<div style="display:flex;justify-content:center;align-items:center;height:100vh;background:#f1f5f9;"><img src="${fileUrl}" style="max-width:90%;max-height:90%;box-shadow:0 10px 25px rgba(0,0,0,0.2);border-radius:8px;"></div>`); }
          };

          const renderWorkShowcase = () => (
            <div className="grid grid-cols-2 gap-3">
              {data.serviceShowcase.map((item) => (
                <div key={item.id} className="aspect-square bg-slate-800 rounded-lg overflow-hidden border border-slate-700 relative group">
                    {isEditing ? (
                      <div className="absolute inset-0 z-10">
                        <FileUploader currentFile={item.image} onFileUpdate={(img) => updateShowcase(item.id, img)} label={item.label} aspectClass="h-full w-full" />
                      </div>
                    ) : (
                      item.image ? (
                        <div className="w-full h-full relative cursor-pointer" onClick={() => openFileViewer(item.image)}>
                            <div className="absolute inset-0 bg-cover bg-center blur-md opacity-60 scale-125" style={{ backgroundImage: `url(${item.image})` }}></div>
                            <img src={item.image} alt={item.label} className="w-full h-full object-contain p-1 relative z-10" />
                            <div className="absolute inset-0 bg-gradient-to-t from-black/90 via-transparent to-transparent flex items-end p-2 pointer-events-none z-20">
                              <span className="text-[9px] text-white font-bold leading-tight">{item.label}</span>
                            </div>
                            <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center z-30 backdrop-blur-[2px]">
                                <div className="bg-white/20 p-2 rounded-full backdrop-blur-md border border-white/30 text-white transform group-hover:scale-110 transition-transform"><Eye size={24} /></div>
                                <span className="absolute bottom-1/4 text-white text-[10px] font-bold bg-black/50 px-2 py-1 rounded">Ver imagen</span>
                            </div>
                        </div>
                      ) : (<div className="w-full h-full flex flex-col items-center justify-center text-slate-600 p-2 text-center bg-slate-800"><Layout size={16} className="mb-1 opacity-50" /><span className="text-[8px] font-bold uppercase">{item.label}</span></div>)
                    )}
                </div>
              ))}
            </div>
          );

          if (!data) return <div className="min-h-screen flex items-center justify-center bg-slate-50 text-slate-500 font-medium"><Loader className="animate-spin mr-2"/> Cargando Portafolio...</div>;

          return (
            <div className="min-h-screen bg-slate-50 text-slate-800 font-sans selection:bg-blue-200">
              <div className="fixed inset-0 z-0 opacity-[0.03] pointer-events-none" style={{ backgroundImage: `url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 20.5V18H0v-2h20v-2H0V8h20V6H0V4h20V2H0V0h22v20h2V0h2v20h2V0h2v20h2V0h2v20h2v2H20v-1.5zM0 20h2v20H0V20zm4 0h2v20H4V20zm4 0h2v20H8V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20zm4 0h2v20h-2V20z' fill='%230f172a' fill-opacity='1' fill-rule='evenodd'/%3E%3C/svg%3E")` }}></div>

              {showAIModal && (
                <div className="fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-end md:items-center justify-center p-4">
                  <div className="bg-white rounded-t-2xl md:rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden animate-fade-in-up flex flex-col max-h-[90vh]">
                    <div className="bg-gradient-to-r from-indigo-900 to-blue-900 p-6 flex justify-between items-start text-white relative overflow-hidden">
                      <div className="absolute top-0 right-0 p-4 opacity-10"><Bot size={120} /></div>
                      <div className="flex gap-4 relative z-10">
                        <div className="bg-white/10 p-3 rounded-full backdrop-blur-md border border-white/20"><div className="relative"><Bot className="text-blue-200" size={32} /><GraduationCap className="absolute -top-2 -right-2 text-yellow-400" size={20} /></div></div>
                        <div><h3 className="font-bold text-xl">Yenner</h3><p className="text-blue-200 text-xs font-medium">Asesor Acad√©mico y Digital</p></div>
                      </div>
                      <button onClick={() => setShowAIModal(false)} className="text-blue-200 hover:text-white z-10"><X size={24}/></button>
                    </div>
                    <div className="p-6 overflow-y-auto bg-slate-50/50">
                      {!aiResponse && !showScheduler && (<><div className="bg-white p-4 rounded-xl shadow-sm border border-blue-100 mb-6"><p className="text-slate-700 text-sm leading-relaxed">üëã <strong>¬°Hola! Soy Yenner.</strong> Cu√©ntame tu idea y te ayudar√©.</p></div><form onSubmit={handleConsultAI} className="space-y-4"><textarea value={aiInput} onChange={(e) => setAiInput(e.target.value)} placeholder="Ej: Necesito un sitio web para mi restaurante..." className="w-full p-4 bg-white border border-slate-200 rounded-xl outline-none focus:ring-2 focus:ring-blue-500 h-32" autoFocus /><button type="submit" disabled={aiLoading} className="w-full bg-blue-600 hover:bg-blue-500 text-white py-4 rounded-xl font-bold text-lg shadow-lg flex items-center justify-center gap-2">{aiLoading ? <Loader className="animate-spin" /> : <Sparkles size={20} />} {aiLoading ? "Analizando..." : "Analizar mi Idea"}</button></form></>)}
                      {aiResponse && !showScheduler && (<div className="space-y-6 animate-fade-in"><div className="bg-white p-5 rounded-xl border border-blue-100 shadow-sm relative"><div className="absolute -top-3 left-4 bg-blue-100 text-blue-700 text-[10px] font-bold px-2 py-1 rounded-full flex items-center gap-1"><Bot size={12} /> An√°lisis</div><p className="text-slate-700 text-sm leading-relaxed whitespace-pre-line mt-2">{aiResponse.advice}</p></div><div className="space-y-3"><a href={`https://wa.me/52${data.profile.phone.replace(/\s/g, '')}?text=${encodeURIComponent(`Hola Genaro, habl√© con Yenner.\n\n${aiResponse.technicalSummary}\n\n>> Solicito COTIZACI√ìN.`)}`} target="_blank" rel="noopener noreferrer" className="w-full bg-white border-2 border-green-500 text-green-600 hover:bg-green-50 py-3 rounded-xl font-bold flex items-center justify-center gap-3"><FileCheck size={20} /> Solicitar Cotizaci√≥n</a><button onClick={() => setShowScheduler(true)} className="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white py-4 rounded-xl font-bold shadow-lg flex items-center justify-center gap-3"><Calendar size={20} /> Agendar Cita con Genaro</button></div><button onClick={() => setAiResponse(null)} className="w-full text-slate-400 text-xs hover:text-blue-600 py-2">Volver</button></div>)}
                      {showScheduler && (<div className="animate-fade-in space-y-6"><div className="flex items-center gap-2 mb-2"><button onClick={() => setShowScheduler(false)} className="text-slate-400 hover:text-blue-600"><ArrowLeft size={20} /></button><h3 className="font-bold text-slate-800 text-lg">Elige tu horario</h3></div><div className="bg-white p-4 rounded-xl shadow-sm border border-slate-200"><label className="block text-xs font-bold text-slate-500 uppercase mb-2">1. Selecciona Fecha</label><input type="date" className="w-full p-3 bg-slate-50 border border-slate-200 rounded-lg outline-none focus:border-blue-500" min={new Date().toISOString().split("T")[0]} onChange={(e) => { setSelectedDate(e.target.value); setSelectedTime(""); }} /></div>{selectedDate && (<div className="bg-white p-4 rounded-xl shadow-sm border border-slate-200"><div className="flex justify-between items-center mb-3"><label className="block text-xs font-bold text-slate-500 uppercase">2. Hora (9am - 6pm)</label><div className="flex gap-2 text-[10px]"><span className="flex items-center gap-1"><span className="w-2 h-2 rounded-full bg-slate-100 border border-slate-300"></span> Libre</span><span className="flex items-center gap-1"><span className="w-2 h-2 rounded-full bg-red-100 border border-red-300"></span> Ocupado</span></div></div><div className="grid grid-cols-4 gap-2">{generateTimeSlots().map((time) => { const isTaken = bookedSlots.includes(time); return (<button key={time} onClick={() => !isTaken && setSelectedTime(time)} disabled={isTaken} className={`py-2 px-1 text-xs rounded-lg font-medium transition-all relative overflow-hidden ${selectedTime === time ? 'bg-blue-600 text-white shadow-md scale-105' : isTaken ? 'bg-red-50 text-red-300 cursor-not-allowed border border-red-100' : 'bg-slate-100 text-slate-600 hover:bg-slate-200'}`}>{time}</button>); })}</div></div>)}{selectedDate && selectedTime && (<button onClick={confirmBooking} disabled={isBooking} className="w-full bg-green-600 hover:bg-green-500 text-white py-4 rounded-xl font-bold shadow-xl flex items-center justify-center gap-2 animate-pulse hover:animate-none disabled:opacity-70 disabled:cursor-wait">{isBooking ? <Loader className="animate-spin" /> : <Check size={20} />} {isBooking ? "Bloqueando Cita..." : "Confirmar Cita por WhatsApp"}</button>)}</div>)}
                    </div>
                  </div>
                </div>
              )}

              {showLoginModal && (
                <div className="fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4">
                  <div className="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-sm relative animate-fade-in-up">
                    <button onClick={() => setShowLoginModal(false)} className="absolute top-4 right-4 text-slate-400 hover:text-slate-600"><X size={20}/></button>
                    <div className="text-center mb-6"><div className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3 text-blue-600"><Lock size={24} /></div><h3 className="text-xl font-bold text-slate-800">Acceso Administrativo</h3></div>
                    <form onSubmit={handleLogin} className="space-y-4"><input type="text" value={loginUser} onChange={(e) => setLoginUser(e.target.value)} className="w-full p-3 bg-slate-50 border rounded-lg" placeholder="Usuario" /><input type="password" value={loginPass} onChange={(e) => setLoginPass(e.target.value)} className="w-full p-3 bg-slate-50 border rounded-lg" placeholder="Contrase√±a" />{loginError && <p className="text-red-500 text-xs font-bold text-center">{loginError}</p>}<button type="submit" className="w-full bg-blue-900 hover:bg-blue-800 text-white py-3 rounded-lg font-bold">Entrar</button></form>
                  </div>
                </div>
              )}

              <nav className="md:hidden fixed top-0 w-full bg-white/95 backdrop-blur-md border-b border-slate-200 z-40 px-6 py-3 flex justify-between items-center shadow-sm">
                <div className="flex flex-col"><span className="font-bold text-blue-900 text-sm">Genaro S√°nchez</span><span className="text-[10px] text-slate-500">Consultor TI</span></div>
                <button onClick={() => setMobileMenuOpen(!mobileMenuOpen)} className="text-slate-600 p-1">{mobileMenuOpen ? <X /> : <Menu />}</button>
              </nav>
              {mobileMenuOpen && (
                <div className="fixed inset-0 z-30 bg-white pt-20 px-6 space-y-4 md:hidden animate-fade-in">
                  {['Inicio', 'Perfil', 'Servicios', 'Certificados'].map(item => (<a key={item} href={`#${item.toLowerCase()}`} onClick={() => setMobileMenuOpen(false)} className="block text-xl font-medium text-slate-800 border-b pb-2">{item}</a>))}
                </div>
              )}

              <div className="relative z-10 max-w-7xl mx-auto md:flex min-h-screen shadow-2xl bg-white/90 md:my-8 md:rounded-2xl overflow-hidden border border-slate-200">
                <aside className="w-full md:w-[380px] lg:w-[420px] bg-slate-900 text-white flex flex-col shrink-0 md:h-screen sticky top-0 overflow-y-auto custom-scrollbar">
                  <div className="p-8 flex flex-col items-center md:items-start text-center md:text-left mt-16 md:mt-0">
                    <div className="w-36 h-36 mb-6 shrink-0 relative mx-auto md:mx-0">
                      {isEditing ? <FileUploader currentFile={data.profile.image} onFileUpdate={(img) => updateField('profile', 'image', img)} label="Subir Foto" circular={true} aspectClass="aspect-square" /> : <img src={data.profile.image || "https://placehold.co/400x400/1e293b/ffffff?text=GS"} alt="Perfil" className="w-full h-full object-cover rounded-full border-[4px] border-slate-700 shadow-xl" />}
                    </div>
                    <div className="w-full space-y-2 mb-6">
                      {isEditing ? <><input value={data.profile.name} onChange={(e) => updateField('profile', 'name', e.target.value)} className="bg-slate-800 w-full p-2 rounded border border-slate-700 font-bold" /><input value={data.profile.title} onChange={(e) => updateField('profile', 'title', e.target.value)} className="bg-slate-800 text-blue-300 w-full p-2 rounded border border-slate-700 text-sm" /></> : <><h1 className="text-2xl font-bold leading-tight">{data.profile.name}</h1><p className="text-blue-400 font-medium text-sm">{data.profile.title}</p></>}
                    </div>
                    <div className="w-full space-y-4 text-slate-300 text-sm border-t border-slate-800 pt-6">
                      <div className="flex items-start gap-3 group"><MapPin size={18} className="text-blue-500 mt-1 shrink-0" />{isEditing ? <input value={data.profile.location} onChange={(e) => updateField('profile', 'location', e.target.value)} className="bg-transparent border-b border-slate-700 w-full" /> : <a href={data.profile.mapUrl} target="_blank" rel="noopener noreferrer" className="hover:text-white transition-colors text-left leading-tight">{data.profile.location}</a>}</div>
                      <div className="flex items-center gap-3"><Mail size={18} className="text-blue-500 shrink-0" />{isEditing ? <input value={data.profile.email} onChange={(e) => updateField('profile', 'email', e.target.value)} className="bg-transparent border-b border-slate-700 w-full" /> : <a href={`mailto:${data.profile.email}`} className="hover:text-white transition-colors">{data.profile.email}</a>}</div>
                      <div className="flex items-center gap-3"><Phone size={18} className="text-blue-500 shrink-0" />{isEditing ? <input value={data.profile.phone} onChange={(e) => updateField('profile', 'phone', e.target.value)} className="bg-transparent border-b border-slate-700 w-full" /> : <div className="flex items-center gap-3 w-full"><a href={`tel:${data.profile.phone.replace(/\s/g, '')}`} className="hover:text-white font-bold transition-colors">{data.profile.phone}</a><a href={`https://wa.me/52${data.profile.phone.replace(/\s/g, '')}?text=Hola`} target="_blank" rel="noopener noreferrer" className="bg-green-600 hover:bg-green-500 text-white p-1.5 rounded-full transition-all ml-auto"><MessageCircle size={16} /></a></div>}</div>
                      <div className="flex items-center gap-3"><Facebook size={18} className="text-blue-500 shrink-0" />{isEditing ? <input value={data.profile.facebookUrl} onChange={(e) => updateField('profile', 'facebookUrl', e.target.value)} className="bg-transparent border-b border-slate-700 w-full" /> : <a href={data.profile.facebookUrl} target="_blank" rel="noopener noreferrer" className="hover:text-blue-400 transition-colors">Perfil de Facebook</a>}</div>
                    </div>
                    <div className="hidden md:block w-full mt-8">
                       <div className="mt-8 pt-6 border-t border-slate-800 mb-8">
                          <h3 className="text-xs font-bold text-slate-500 uppercase tracking-widest mb-4 flex items-center gap-2"><Award size={14} /> Credenciales Destacadas</h3>
                          <div className="space-y-6">
                            {data.certificates.slice(0, 3).map((cert) => (
                              <div key={cert.id} className="bg-slate-800 rounded-xl overflow-hidden border border-slate-700 shadow-lg group">
                                 <div className={`aspect-video bg-slate-900 relative ${cert.image && cert.image.includes('application/pdf') ? '' : ''}`}>
                                    {isEditing ? (<FileUploader currentFile={cert.image} onFileUpdate={(img) => updateCert(cert.id, 'image', img)} label="Subir" aspectClass="h-full w-full" allowPdf={true} />) 
                                        : (cert.image ? (cert.image.includes('application/pdf') ? (<div className="w-full h-full relative cursor-pointer group" onClick={() => openFileViewer(cert.image)}><FileUploader currentFile={cert.image} onFileUpdate={()=>{}} label="" aspectClass="h-full w-full" allowPdf={true} /><div className="absolute bottom-2 right-2 bg-black/60 text-white text-[9px] px-2 py-1 rounded font-bold backdrop-blur-md flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity z-30"><ExternalLink size={10} /> PDF</div><div className="absolute inset-0 z-40"></div></div>) : (<><div className="absolute inset-0 bg-cover bg-center blur-md opacity-60 scale-125" style={{ backgroundImage: `url(${cert.image})` }}></div><img src={cert.image} alt={cert.title} className="w-full h-full object-contain p-1 relative z-10" /></>)) : <div className="w-full h-full flex items-center justify-center text-slate-600"><FileText size={32}/></div>)
                                    }
                                 </div>
                                 <div className="p-3"><h4 className="text-xs font-bold text-white leading-tight mb-1">{cert.title}</h4><p className="text-[10px] text-slate-400">{cert.issuer}</p></div>
                              </div>
                            ))}
                          </div>
                       </div>
                    </div>
                    <div className="mt-auto w-full flex justify-between items-center pt-4 border-t border-slate-800"><button onClick={() => isAuthenticated ? (setIsAuthenticated(false), setIsEditing(false)) : setShowLoginModal(true)} className="text-slate-600 hover:text-white transition-colors p-2">{isAuthenticated ? <LogOut size={16} /> : <Lock size={16} />}</button><span className="text-[10px] text-slate-600">¬© 2025 Genaro S√°nchez</span></div>
                  </div>
                </aside>

                <main className="flex-1 bg-white p-6 md:p-10 lg:p-16 overflow-y-auto">
                  <section id="perfil" className="mb-12">
                    <h2 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-6 flex items-center gap-2"><span className="w-6 h-[2px] bg-blue-500"></span> Perfil Profesional</h2>
                    {isEditing ? <textarea value={data.profile.bio} onChange={(e) => updateField('profile', 'bio', e.target.value)} className="w-full h-32 p-4 border rounded bg-slate-50 leading-relaxed text-sm mb-6" /> : <p className="text-slate-600 leading-7 text-justify font-light mb-8">{data.profile.bio}</p>}
                    <div className="bg-blue-50/50 rounded-xl p-6 border border-blue-100 mb-8">
                       <h3 className="text-sm font-bold text-blue-900 mb-4 flex items-center gap-2"><GraduationCap size={18} /> Formaci√≥n Acad√©mica Actual</h3>
                       <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                         {data.profile.education.map((edu) => (
                           <div key={edu.id} className="bg-white p-4 rounded-lg shadow-sm border border-blue-100"><span className="text-[10px] font-bold bg-green-100 text-green-700 px-2 py-0.5 rounded-full mb-2 inline-block">{edu.status}</span><h4 className="font-bold text-slate-800 text-sm leading-tight mb-1">{edu.title}</h4><p className="text-xs text-slate-500">{edu.school}</p></div>
                         ))}
                       </div>
                    </div>
                    <div className="flex flex-wrap gap-2">{data.profile.skills.map((skill, i) => (<span key={i} className="px-3 py-1 bg-slate-100 text-slate-600 text-[11px] font-bold rounded uppercase tracking-wider">{skill}</span>))}</div>
                  </section>

                  <div className="md:hidden mb-12"><h2 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-6 flex items-center gap-2"><span className="w-6 h-[2px] bg-blue-500"></span> Muestras de Trabajo</h2><div className="bg-slate-900 p-4 rounded-xl">{renderWorkShowcase()}</div></div>

                  <section id="servicios" className="mb-16">
                    <div className="flex items-center justify-between mb-8 flex-wrap gap-4"><h2 className="text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2"><span className="w-6 h-[2px] bg-blue-500"></span> Cat√°logo de Servicios</h2><button onClick={() => setShowAIModal(true)} className="bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-500 hover:to-blue-500 text-white px-4 py-2 rounded-full shadow-lg flex items-center gap-2 text-xs font-bold animate-pulse hover:animate-none transition-all"><Bot size={16} /> Hablar con Yenner (IA)</button></div>
                    <div className="flex flex-col lg:flex-row gap-8 items-start">
                        <div className="hidden lg:block w-64 xl:w-72 shrink-0 sticky top-4"><h3 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-6 flex items-center gap-2"><span className="w-6 h-[2px] bg-blue-500"></span> Muestras</h3>{renderWorkShowcase()}</div>
                        <div className="flex-1 grid grid-cols-1 xl:grid-cols-2 gap-6">
                          {data.services.map((service) => { const Icon = IconMap[service.icon] || Server; return (<div key={service.id} className="bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-xl hover:border-blue-300 transition-all duration-300 group flex flex-col h-full overflow-hidden"><div className="p-6 pb-4 bg-slate-50/50 border-b border-slate-100"><div className="flex justify-between items-start mb-3"><div className="p-2 bg-blue-100 text-blue-600 rounded-lg group-hover:bg-blue-600 group-hover:text-white transition-colors"><Icon size={24} /></div><span className="text-[10px] font-bold uppercase tracking-wide text-slate-400 bg-white px-2 py-1 rounded border border-slate-100">{service.category}</span></div><h3 className="font-bold text-lg text-slate-800 leading-tight mb-2">{service.title}</h3><p className="text-xs text-slate-500 line-clamp-2">{service.desc}</p></div><div className="p-6 pt-4 flex-1 flex flex-col"><div className="mb-6 flex-1"><ul className="space-y-2">{service.features && service.features.map((feat, i) => (<li key={i} className="flex items-start gap-2 text-sm text-slate-600"><Check size={14} className="text-green-500 mt-1 shrink-0" /><span className="leading-tight">{feat}</span></li>))}</ul></div><div className="mt-auto pt-4 border-t border-slate-100"><div className="flex items-end justify-between mb-3"><span className="text-xs text-slate-400">Inversi√≥n:</span><span className="font-bold text-lg text-blue-900">{service.price}</span></div><a href={`https://wa.me/52${data.profile.phone.replace(/\s/g, '')}?text=Hola, me interesa el servicio de ${service.title}`} target="_blank" rel="noopener noreferrer" className="w-full py-3 bg-slate-900 hover:bg-green-600 text-white rounded-lg text-sm font-bold transition-colors flex items-center justify-center gap-2 group-hover:bg-green-600"><Smartphone size={16} /> Cotizar por WhatsApp</a></div></div></div>); })}
                        </div>
                    </div>
                  </section>

                  <section id="certificados-full">
                    <h2 className="text-xs font-bold text-slate-400 uppercase tracking-widest mb-6 flex items-center gap-2"><span className="w-6 h-[2px] bg-blue-500"></span> Credenciales y Certificaciones</h2>
                    <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
                      {data.certificates.map((cert) => (
                        <div key={cert.id} className="group relative bg-white rounded-lg border border-slate-100 overflow-hidden hover:shadow-lg transition-all hover:border-blue-200">
                          <div className={`aspect-[4/3] bg-slate-50 relative flex items-center justify-center ${cert.image && cert.image.includes('application/pdf') ? '' : 'p-4'}`}>
                             {isEditing ? (<div className="absolute inset-0 z-20 bg-white/50 p-2"><FileUploader currentFile={cert.image} onFileUpdate={(img) => updateCert(cert.id, 'image', img)} label="+" aspectClass="h-full w-full" allowPdf={true} /></div>) : 
                             (cert.image ? (cert.image.includes('application/pdf') ? (<div className="w-full h-full relative cursor-pointer group" onClick={() => openFileViewer(cert.image)}><FileUploader currentFile={cert.image} onFileUpdate={()=>{}} label="" aspectClass="h-full w-full" allowPdf={true} /><div className="absolute bottom-2 right-2 bg-black/60 text-white text-[9px] px-2 py-1 rounded font-bold backdrop-blur-md flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity z-30"><ExternalLink size={10} /> PDF</div><div className="absolute inset-0 z-40"></div></div>) : (<><div className="absolute inset-0 bg-cover bg-center blur-md opacity-60 scale-125" style={{ backgroundImage: `url(${cert.image})` }}></div><img src={cert.image} alt={cert.title} className="w-full h-full object-contain p-1 relative z-10" /></>)) : <div className="text-center opacity-30 group-hover:opacity-60 transition-opacity"><Award size={32} className="mx-auto mb-1 text-slate-400" /></div>)}
                          </div>
                          <div className="p-3 border-t border-slate-50"><h4 className="text-xs font-bold text-slate-800 leading-tight mb-1 truncate" title={cert.title}>{cert.title}</h4><p className="text-[10px] text-slate-500 truncate">{cert.issuer} ‚Ä¢ {cert.date}</p></div>
                        </div>
                      ))}
                    </div>
                  </section>
                </main>
              </div>

              {isAuthenticated && (<button onClick={isEditing ? saveDataToCloud : () => setIsEditing(true)} disabled={isSaving} className={`fixed bottom-6 right-6 z-50 p-4 rounded-full shadow-2xl transition-all hover:scale-110 flex items-center gap-2 ${isEditing ? 'bg-green-600 text-white' : 'bg-blue-600 text-white'} ${isSaving ? 'opacity-75 cursor-wait' : ''}`}>{isSaving ? <Loader className="animate-spin" size={24} /> : (isEditing ? <Save size={24} /> : <Edit2 size={24} />)}<span className="font-bold hidden md:inline pr-2">{isSaving ? "Guardando..." : (isEditing ? "Guardar Cambios" : "Editar")}</span></button>)}
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Portfolio />);
    </script>
</body>
</html>
